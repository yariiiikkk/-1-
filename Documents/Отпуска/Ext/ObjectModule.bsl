           Процедура ПриЗаписи(Отказ)
    // Проверка на заполненность обязательных полей
    Если ПустаяСтрока(Сотрудник) Или ПустаяСтрока(ДатаНачалаОтпуска) Или ПустаяСтрока(ДатаОкончанияОтпуска) Тогда
        Отказ = Истина;
        Сообщить("Заполните все обязательные поля.");
        Возврат;
    КонецЕсли;

    // Поиск сотрудника в справочнике "Сотрудники"
    СотрудникЗапись = Справочники.Сотрудники.НайтиПоНаименованию(Сотрудник);
    
    Если СотрудникЗапись = Неопределено Тогда
        Отказ = Истина;
        Сообщить("Сотрудник не найден.");
        Возврат;
    КонецЕсли;

    // Загрузка объекта для редактирования
    СотрудникОбъект = СотрудникЗапись.ПолучитьОбъект();

    // Проверка текущего статуса
    Если СотрудникОбъект.Статус = Перечисления.СтатусыСотрудников.Уволенный Тогда
        Отказ = Истина;
        Сообщить("Сотрудник уволен и не может взять отпуск.");
        Возврат;
    КонецЕсли;

    // Проверка, что даты отпуска корректны
    Если ДатаНачалаОтпуска >= ДатаОкончанияОтпуска Тогда
        Отказ = Истина;
        Сообщить("Дата начала отпуска должна быть раньше даты окончания отпуска.");
        Возврат;
    КонецЕсли;

    // Проверка, что даты отпуска находятся в пределах текущего года или другого разумного диапазона
    Если ДатаНачалаОтпуска < ТекущаяДата() Или ДатаОкончанияОтпуска < ТекущаяДата() Тогда
        Отказ = Истина;
        Сообщить("Даты отпуска не могут быть в прошлом.");
        Возврат;
    КонецЕсли;

    // Обновление статуса сотрудника на "В отпуске"
    Попытка
        СотрудникОбъект.Статус = Перечисления.СтатусыСотрудников.ВОтпуске;
        СотрудникОбъект.Записать(); // Сохранение изменений статуса сотрудника
        
        Сообщить("Информация об отпуске успешно сохранена и статус сотрудника обновлен.");
        
    Исключение
        Сообщить("Ошибка при обновлении статуса сотрудника: " + ОписаниеОшибки());
        Отказ = Истина;
    КонецПопытки;
КонецПроцедуры
